{"title":"Python 爬虫实现天气查询（可视化界面版）","slug":"Python-tianqi","date":"2018-09-02T02:37:29.000Z","updated":"2018-09-02T02:49:41.249Z","comments":true,"path":"api/articles/Python-tianqi.json","photos":[],"link":"","excerpt":"Python 实现天气查询的程序早已完成，近日开学无课，昨晚心血来潮想做一个较为友好的界面版本，便匆忙行动了起来。在之前已有的程序的基础上使用Tkinter 模块实现GUI 并不是很难，但是在做的过程中《我的英雄学院》更新了，所以中途耽误了，今天早上才做好。（~.~）<br>","covers":["/static/images/python/tianqi.png","/static/images/python/tianqi1.png"],"content":"<p>Python 实现天气查询的程序早已完成，近日开学无课，昨晚心血来潮想做一个较为友好的界面版本，便匆忙行动了起来。</p>\n<p>在之前已有的程序的基础上使用Tkinter 模块实现GUI 并不是很难，但是在做的过程中《我的英雄学院》更新了，所以中途耽误了，今天早上才做好。（~.~）<br><a id=\"more\"></a>  </p>\n<p>代码的主体是爬虫与Tkinter。</p>\n<p>执行程序后会先出现一个选择城市的界面，这里需要输入城市名。点击确认即会出现城市天气状况。</p>\n<p>执行效果如下：</p>\n<p><img src=\"/static/images/python/tianqi.png\" alt=\"tianqi\"></p>\n<p><img src=\"/static/images/python/tianqi1.png\" alt=\"tianqi1\"></p>\n<p>源代码：<br>‘’’Python<br>from tkinter import *<br>import urllib.request<br>import gzip<br>import json<br>from tkinter import messagebox</p>\n<p>root = Tk()</p>\n<p>def main():</p>\n<pre><code>#输入窗口\nroot.title(&apos;天气查询&apos;)#窗口标题\nLabel(root,text = &apos;请输入城市&apos;).grid(row=0,column=0)#设置标签并调整位置\nenter = Entry(root)#输入框\nenter.grid(row = 0,column=1,padx = 20, pady = 20)#调整位置\nenter.delete(0,END)#清空输入框\nenter.insert(0,&apos;湘潭&apos;)#设置默认文本\n#enter_text = enter.get()#获取输入框的内容\n\nrunning = 1\n\ndef get_weather_data() :#获取网站数据\n    city_name = enter.get()#获取输入框的内容\n    url1 = &apos;http://wthrcdn.etouch.cn/weather_mini?city=&apos;+urllib.parse.quote(city_name)\n    url2 = &apos;http://wthrcdn.etouch.cn/weather_mini?citykey=101010100&apos;\n    #网址1只需要输入城市名，网址2需要输入城市代码\n    #print(url1)\n    weather_data = urllib.request.urlopen(url1).read()\n    #读取网页数据\n    weather_data = gzip.decompress(weather_data).decode(&apos;utf-8&apos;)\n    #解压网页数据\n    weather_dict = json.loads(weather_data)\n    #将json数据转换为dict数据\n    if weather_dict.get(&apos;desc&apos;) == &apos;invilad-citykey&apos;:\n        print(messagebox.askokcancel(&quot;xing&quot;,&quot;你输入的城市名有误，或者天气中心未收录你所在城市&quot;))\n    else:\n        #print(messagebox.askokcancel(&apos;xing&apos;,&apos;bingguo&apos;))\n        show_data(weather_dict,city_name)\n\ndef show_data(weather_dict,city_name):#显示数据\n    forecast = weather_dict.get(&apos;data&apos;).get(&apos;forecast&apos;)#获取数据块\n    root1=Tk()#副窗口\n    root1.geometry(&apos;650x280&apos;)#修改窗口大小\n    root1.title(city_name + &apos;天气状况&apos;)#副窗口标题\n\n    #设置日期列表\n    for i in range(5):#将每一天的数据放入列表中\n        LANGS = [(forecast[i].get(&apos;date&apos;),&apos;日期&apos;),\n                    (forecast[i].get(&apos;fengxiang&apos;),&apos;风向&apos;),\n                    (str(forecast[i].get(&apos;fengji&apos;)),&apos;风级&apos;),\n                    (forecast[i].get(&apos;high&apos;),&apos;最高温&apos;),\n                    (forecast[i].get(&apos;low&apos;),&apos;最低温&apos;),\n                    (forecast[i].get(&apos;type&apos;),&apos;天气&apos;)]\n        group = LabelFrame(root1,text = &apos;天气状况&apos;,padx = 0,pady = 0)#框架\n        group.pack(padx=11,pady=0,side = LEFT)#放置框架\n        for lang, value in LANGS:#将数据放入框架中\n            c = Label(group,text = value + &apos;: &apos; + lang)\n            c.pack(anchor = W)\n    Label(root1,text = &apos;今日&apos; + weather_dict.get(&apos;data&apos;).get(&apos;ganmao&apos;),\n            fg = &apos;green&apos;).place(x=40,y=20,height=40)#温馨提示\n    Label(root1,text = &quot;StarMan: 49star.com&quot;,fg = &quot;green&quot;,bg = &quot;yellow&quot;).place(x=10,y=255,width=125,height=20)#作者网站\n    Button(root1,text = &apos;确认并退出&apos;,width=10,command = root1.quit).place(x=500,y=230,width = 80,height=40)#退出按钮\n    root1.mainloop()\n\n#布置按键    \nButton(root, text = &quot;确认&quot;,width=10,command = get_weather_data)\\\n        .grid(row = 3, column=0,sticky = W, padx = 10, pady = 5)\nButton(root, text = &apos;退出&apos;,width=10,command = root.quit)\\\n        .grid(row = 3, column = 1, sticky = E, padx = 10, pady = 5)\nif running==1:\n    root.mainloop()\n</code></pre><p>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    main()</p>\n<p>‘’’<br>今天海贼王更新！！共勉！</p>\n","categories":[{"name":"Python","slug":"Python","count":2,"path":"api/categories/Python.json"}],"tags":[{"name":"Python","slug":"Python","count":2,"path":"api/tags/Python.json"}]}